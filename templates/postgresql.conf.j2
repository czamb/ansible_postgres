#------------------------------------------------------------------------------
# CONNECTIONROR REPORTING AND LOGGING
#------------------------------------------------------------------------------
# PostgreSQL server configuration fragment.
# See /usr/share/postgresql-*/postgresql.conf.sample for a more complete
# example. Custom changes may be configured in /etc/postgresql.
# Managed by Puppet: do not edit this file directly. It will be overwritten!
log_destination = 'syslog'
syslog_facility = 'LOCAL3'
log_min_duration_statement = 1000
log_checkpoints = on
log_connections = on
log_line_prefix = 'user=%u,db=%d '
log_lock_waits = on
log_autovacuum_min_duration = 5000
log_temp_files = 1kB
shared_preload_libraries = 'auto_explain'
auto_explain.log_min_duration = '3s'
#------------------------------------------------------------------------------
# CLIENT CONNECTION DEFAULTS
#------------------------------------------------------------------------------
# PostgreSQL server configuration fragment.
# See /usr/share/postgresql-*/postgresql.conf.sample for a more complete
# example. Custom changes may be configured in /etc/postgresql.
# Managed by Puppet: do not edit this file directly. It will be overwritten!
datestyle = 'iso, mdy'
lc_messages = 'en_US.utf8'
lc_monetary = 'en_US.utf8'
lc_numeric = 'en_US.utf8'
lc_time = 'en_US.utf8'
# custom config added here will go into postgresql.conf
max_connections = 400
#------------------------------------------------------------------------------
# RESOURCE USAGE (except WAL)
#------------------------------------------------------------------------------
# PostgreSQL server configuration fragment.
# See /usr/share/postgresql-*/postgresql.conf.sample for a more complete
# example. Custom changes may be configured in /etc/postgresql.
# Managed by Puppet: do not edit this file directly. It will be overwritten!
shared_buffers = {{ postgres_shared_buffers }}  # starting point is 25% RAM
temp_buffers = 16MB
work_mem = 1MB
maintenance_work_mem = 50MB
#------------------------------------------------------------------------------
# QUERY TUNING
#------------------------------------------------------------------------------
random_page_cost = 3.0
effective_cache_size = {{ postgres_effective_cache_size }}
# version-specific resource settings for 9.3
effective_io_concurrency = 100
#------------------------------------------------------------------------------
# WRITE AHEAD LOG
#------------------------------------------------------------------------------
# PostgreSQL server configuration fragment.
# See /usr/share/postgresql-*/postgresql.conf.sample for a more complete
# example. Custom changes may be configured in /etc/postgresql.
# Managed by Puppet: do not edit this file directly. It will be overwritten!
wal_level = hot_standby
wal_buffers = 7MB
wal_keep_segments = 0
commit_delay = 200
checkpoint_segments = 100
checkpoint_completion_target = 0.9
archive_mode = off
archive_timeout = 60
data_directory='/var/lib/postgresql/9.3/main'
unix_socket_directories='/var/run/postgresql'
